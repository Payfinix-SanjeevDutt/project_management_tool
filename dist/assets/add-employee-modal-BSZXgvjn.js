import{ai as S,r as n,aj as T,_ as x,j as s,aR as B,B as h,k as p,al as j,c as u,H as k,a7 as y,a8 as b,d3 as F,an as f}from"./index-BXVaN-Bg.js";import{A as I}from"./Autocomplete-DxNy6pfN.js";import{C as L}from"./DialogContent-CxPgUekA.js";import{L as P}from"./LoadingButton-L3kQ20Ll.js";function H({handleClose:i,open:d=!1}){const v=S(e=>e.projects.currentProjectId),[c,g]=n.useState("Member"),A=T(),[E,_]=n.useState([]),[m,C]=n.useState([]),l=x(),r=x(),w=async()=>{l.onTrue();try{const e=await y.get(b.user.list),{status:a,data:o}=e.data;a?_(o):console.error("Unexpected response format",e)}catch(e){console.error("Failed to fetch emails:",e)}l.onFalse()},M=(e,a)=>{C(a)},R=async()=>{r.onTrue();try{const e={project_id:v,role:c,employees:m.map(t=>t.employee_id)},a=await y.post(b.project.project_users_create,e),{status:o}=a.data;o&&(A(F(m.map(t=>({...t,role:c,access_status:"GRANT"})))),f.success("Existing employees added successfully!"),i())}catch{f.error("failed to add employees")}r.onFalse()};return n.useEffect(()=>{d&&w()},[d]),s.jsx(B,{open:d,onClose:i,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:s.jsxs(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",md:500},bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2},children:[s.jsx(p,{id:"modal-modal-title",variant:"h6",component:"h2",sx:{mb:2},children:"Add People to Project"}),s.jsx(p,{variant:"subtitle1",sx:{mb:1},children:"Names and emails"}),s.jsx(I,{multiple:!0,options:E,getOptionLabel:e=>e.employee_email,value:m,onChange:M,renderTags:(e,a)=>e.map((o,t)=>s.jsx(L,{label:o.employee_email,...a({index:t})},t)),renderInput:e=>s.jsx(j,{...e,placeholder:l.value?"Loading emails...":"Add more people...",variant:"outlined"}),sx:{mb:2},loading:l.value}),s.jsx(p,{variant:"subtitle1",sx:{mb:1},children:"Role"}),s.jsxs(j,{select:!0,onChange:e=>g(e.target.value),fullWidth:!0,value:c,variant:"outlined",sx:{mb:3},children:[s.jsx(u,{value:"Member",children:"Member"}),s.jsx(u,{value:"Admin",children:"Admin"}),s.jsx(u,{value:"Viewer",children:"Viewer"})]}),s.jsxs(h,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[s.jsx(k,{variant:"outlined",onClick:i,disabled:r.value,children:"Cancel"}),s.jsx(P,{variant:"contained",onClick:R,loading:r.value,children:"Add Employees"})]})]})})}export{H as A};
