import{r as x,aT as S,d4 as T,ai as W,l as G,j as t,f as N,G as k,S as d,k as h,al as l,c as B,N as O,W as g,ah as f,a7 as j,a8 as _,an as i,B as U,H as C}from"./index-BXVaN-Bg.js";import{U as F}from"./image-DGI4zpN2.js";import{C as L}from"./custom-breadcrumbs-DVNouI9r.js";import{C as R}from"./CardHeader-CynLBTsA.js";import{D as m}from"./DatePicker-01LY8aSd.js";const H={project_id:"",name:"",status:"PLANNED",description:"",start_date:f(),end_date:f(),actual_start_date:null,actual_end_date:null,cover_img:null},M=[{value:"ON_GOING",label:"On Going"},{value:"COMPLETED",label:"Completed"},{value:"PLANNED",label:"Planned"}];function V(){const{user:u}=x.useContext(S),P=T(),{currentProjectId:b}=W(e=>e.projects),[n,v]=x.useState(H),y=G(),c=P!=="/main/projects/create",o=e=>{const{name:a,value:s}=e.target;v(r=>({...r,[a]:s}))},D=async()=>{try{if(!(u!=null&&u.employee_id))throw new Error("employee id is not found");const e=await j.post(_.project.create,{...n,employee_id:u.employee_id}),{error_code:a,message:s}=e.data;if(a!==0)throw new Error(s);i.success(s),y(g.main.project.root)}catch(e){const a=e instanceof Error&&e.message||typeof e=="object"&&(e==null?void 0:e.message)||e;i.error(a)}},p=e=>e?f(e):null,I=async()=>{try{const e=await j.post(_.project.display,{project_id:b}),{error_code:a,message:s,data:r}=e.data;if(a!==0)throw new Error(s);v({...r,start_date:p(r.start_date),end_date:p(r.end_date),actual_start_date:p(r.actual_start_date),actual_end_date:p(r.actual_end_date)})}catch(e){const a=e instanceof Error&&e.message||typeof e=="object"&&(e==null?void 0:e.message)||e;i.error(a)}},w=async()=>{try{const e=await j.post(_.project.update,n),{error_code:a,message:s,data:r}=e.data;if(a!==0)throw new Error(s);i.success(s)}catch(e){const a=e instanceof Error&&e.message||typeof e=="object"&&(e==null?void 0:e.message);i.success(a)}};x.useEffect(()=>{c&&I()},[c]);const E=t.jsxs(N,{children:[t.jsx(R,{title:c?"update":"Create",subheader:"Title, short description, etc.",sx:{mb:3}}),t.jsx(k,{}),t.jsxs(d,{gap:3,sx:{p:3},children:[t.jsxs(d,{spacing:2,children:[t.jsx(h,{variant:"subtitle2",children:"Project Details"}),t.jsx(l,{name:"name",label:"Title",variant:"outlined",fullWidth:!0,value:n.name,onChange:o}),t.jsx(l,{name:"description",label:"Description",multiline:!0,value:n.description,rows:3,variant:"outlined",fullWidth:!0,onChange:o}),t.jsx(l,{fullWidth:!0,select:!0,name:"status",label:"Project Status",value:n.status,onChange:o,children:M.map(e=>t.jsx(B,{value:e.value,children:e.label},e.value))})]}),t.jsx(h,{variant:"subtitle2",children:"Work Schedule"}),t.jsxs(t.Fragment,{children:[t.jsxs(d,{direction:"row",gap:2,children:[t.jsx(m,{label:"Start Date",name:"start_date",value:n.start_date,onChange:e=>o({target:{name:"start_date",value:e}}),renderInput:e=>{var a;return t.jsx(l,{...e,fullWidth:!0,variant:"outlined",InputProps:{...e.InputProps,endAdornment:(a=e.InputProps)==null?void 0:a.endAdornment}})},sx:{flexGrow:1}}),t.jsx(m,{label:"End Date",name:"end_date",value:n.end_date,onChange:e=>o({target:{name:"end_date",value:e}}),renderInput:e=>{var a;return t.jsx(l,{...e,fullWidth:!0,variant:"outlined",InputProps:{...e.InputProps,endAdornment:(a=e.InputProps)==null?void 0:a.endAdornment}})},sx:{flexGrow:1}})]}),t.jsxs(d,{direction:"row",gap:2,children:[t.jsx(m,{label:"Actual Start Date",name:"actual_start_date",value:n.actual_start_date,onChange:e=>o({target:{name:"actual_start_date",value:e}}),renderInput:e=>{var a;return t.jsx(l,{...e,fullWidth:!0,variant:"outlined",InputProps:{...e.InputProps,endAdornment:(a=e.InputProps)==null?void 0:a.endAdornment}})},sx:{flexGrow:1}}),t.jsx(m,{label:"Actual End Date",name:"actual_end_date",value:n.actual_end_date,onChange:e=>o({target:{name:"actual_end_date",value:e}}),renderInput:e=>{var a;return t.jsx(l,{...e,fullWidth:!0,variant:"outlined",InputProps:{...e.InputProps,endAdornment:(a=e.InputProps)==null?void 0:a.endAdornment}})},sx:{flexGrow:1}})]})]}),t.jsx(h,{variant:"subtitle2",children:"Cover"}),t.jsx(F,{name:"cover_img",sx:{},value:n.files,onDelete:()=>{},onUpload:()=>{},onRemove:()=>{},onRemoveAll:()=>{}})]})]}),A=t.jsx(U,{display:"flex",alignItems:"center",justifyContent:"flex-end",children:t.jsxs(d,{direction:"row",gap:3,children:[t.jsx(C,{color:"inherit",variant:"outlined",onClick:()=>{},children:"Back"}),t.jsx(C,{color:"primary",variant:"contained",onClick:c?w:D,children:c?"update":"save"})]})});return t.jsxs(O,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[t.jsx(L,{heading:"List",links:[{name:"Dashboard",href:g.dashboard.root},{name:"Create"}],sx:{mb:{xs:3,md:5}}}),t.jsxs(d,{spacing:{xs:3,md:5},sx:{mx:"auto",minWidth:{xs:200,md:800,xl:880},maxWidth:{xs:720,xl:880}},children:[E,A]})]})}export{V as C};
