import{ah as D,r as P,aT as _,a7 as I,a8 as T,an as q,j as s,f as w,k as j,L as V,B as k,S as C,_ as z,a1 as h,a2 as b,I as u,N as G,W as B,aH as U,T as Z,P as p,e as L}from"./index-BXVaN-Bg.js";import{u as O}from"./use-tabs-eJRS1d9i.js";import{C as H}from"./custom-breadcrumbs-DVNouI9r.js";import{z as n,t as A,F as N}from"./form-provider-BUA45YJV.js";import{i as J,u as F,F as l}from"./fields-CtJmr7vf.js";import{d as R}from"./format-number-DrEElRjc.js";import"./image-DGI4zpN2.js";import{G as f}from"./Grid2-BjjkDMBF.js";import{L as S}from"./LoadingButton-L3kQ20Ll.js";import"./Breadcrumbs-DjhM_bul.js";import"./date-time-utils-CU9-YODR.js";import"./DatePicker-01LY8aSd.js";import"./createStyled-mUU3E4G-.js";import"./DialogContent-CxPgUekA.js";import"./FormControlLabel-BRFnA9-2.js";import"./utils-crRmHoXN.js";import"./Autocomplete-DxNy6pfN.js";import"./Checkbox-DIz0V3dn.js";import"./CircularProgress-DeAomXPU.js";const v={phoneNumber:e=>{var a,r;return n.string().min(1,{message:((a=e==null?void 0:e.message)==null?void 0:a.required_error)??"Phone number is required!"}).refine(t=>{var i;return(i=e==null?void 0:e.isValidPhoneNumber)==null?void 0:i.call(e,t)},{message:((r=e==null?void 0:e.message)==null?void 0:r.invalid_type_error)??"Invalid phone number!"})},date:e=>n.coerce.date().nullable().transform((a,r)=>{var m,c;const t=D(a).format(),i=n.string().pipe(n.coerce.date());return a?(i.safeParse(t).success||r.addIssue({code:n.ZodIssueCode.invalid_date,message:((c=e==null?void 0:e.message)==null?void 0:c.invalid_type_error)??"Invalid Date!!"}),t):(r.addIssue({code:n.ZodIssueCode.custom,message:((m=e==null?void 0:e.message)==null?void 0:m.required_error)??"Date is required!"}),null)}).pipe(n.union([n.number(),n.string(),n.date(),n.null()])),editor:e=>{var a;return n.string().min(8,{message:((a=e==null?void 0:e.message)==null?void 0:a.required_error)??"Editor is required!"})},objectOrNull:e=>{var a,r;return n.custom().refine(t=>t!==null,{message:((a=e==null?void 0:e.message)==null?void 0:a.required_error)??"Field is required!"}).refine(t=>t!=="",{message:((r=e==null?void 0:e.message)==null?void 0:r.required_error)??"Field is required!"})},boolean:e=>{var a;return n.coerce.boolean().refine(r=>r===!0,{message:((a=e==null?void 0:e.message)==null?void 0:a.required_error)??"Switch is required!"})},file:e=>n.custom().transform((a,r)=>{var i;return a instanceof File||typeof a=="string"&&!!a.length?a:(r.addIssue({code:n.ZodIssueCode.custom,message:((i=e==null?void 0:e.message)==null?void 0:i.required_error)??"File is required!"}),null)}),files:e=>n.array(n.custom()).transform((a,r)=>{var i;const t=(e==null?void 0:e.minFiles)??2;return a.length?a.length<t&&r.addIssue({code:n.ZodIssueCode.custom,message:`Must have at least ${t} items!`}):r.addIssue({code:n.ZodIssueCode.custom,message:((i=e==null?void 0:e.message)==null?void 0:i.required_error)??"Files is required!"}),a})},W=n.object({name:n.string().min(1,{message:"Name is required!"}),email:n.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),mobile:v.phoneNumber({isValidPhoneNumber:J}),avatar:v.file({message:{required_error:"Avatar is required!"}}).nullable(),address:n.string().nullable(),employee_id:n.string().nullable(),job_title:n.string().nullable(),organization:n.string().nullable(),department:n.string().nullable()});function $(){const{user:e}=P.useContext(_),a={employee_id:(e==null?void 0:e.employee_id)||"",name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||"",avatar:(e==null?void 0:e.avatar)||"Avatar",mobile:(e==null?void 0:e.mobile)||"",address:(e==null?void 0:e.address)||"",job_title:(e==null?void 0:e.job_title)||"",organization:(e==null?void 0:e.organization)||"",department:(e==null?void 0:e.department)||"",created_date:(e==null?void 0:e.created_date)||"",verification:(e==null?void 0:e.verification)||""},r=F({mode:"all",resolver:A(W),defaultValues:a}),{handleSubmit:t,formState:{isSubmitting:i}}=r,m=t(async c=>{try{const d=await I.post(T.user.account,c),{error_code:g,message:o}=d.data;if(q.success("Update success!"),g!==0)throw new Error(o||"An error occurred while updating the user.");return{status:!0,message:"user updated successfully"}}catch(d){return console.error("Error during user reset:",d),{status:!1,message:d instanceof Error?d.message:"An unknown error occurred"}}});return s.jsx(N,{methods:r,onSubmit:m,children:s.jsxs(f,{container:!0,spacing:3,children:[s.jsx(f,{xs:12,md:4,children:s.jsxs(w,{sx:{pt:10,pb:5,px:3,textAlign:"center"},children:[s.jsx(l.UploadAvatar,{name:"avatar",maxSize:3145728,helperText:s.jsxs(j,{variant:"caption",sx:{my:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:["Allowed *.jpeg, *.jpg, *.png, *.gif",s.jsx("br",{})," max size of ",R(3145728)]})}),s.jsxs(j,{variant:"body2",children:["Joined on ",r.getValues().created_date]}),s.jsx(V,{color:r.getValues().verification==="VERIFIED"&&"success"||r.getValues().verification==="PENDING"&&"warning"||"error",sx:{position:"absolute",top:24,right:24},children:r.getValues().verification})]})}),s.jsx(f,{xs:12,md:8,children:s.jsxs(w,{sx:{p:3},children:[s.jsxs(k,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[s.jsx(l.Text,{name:"name",label:"Name"}),s.jsx(l.Text,{name:"email",label:"Email address"}),s.jsx(l.Phone,{name:"mobile",label:"Phone number",country:"IN"}),s.jsx(l.Text,{name:"organization",label:"Organization"}),s.jsx(l.Text,{name:"department",label:"Department"}),s.jsx(l.Text,{name:"job_title",label:"Job Title"})]}),s.jsx(l.Text,{name:"address",label:"Address",multiline:!0,rows:5,sx:{mt:3}}),s.jsx(C,{spacing:3,alignItems:"flex-end",sx:{mt:3},children:s.jsx(S,{type:"submit",variant:"contained",loading:i,children:"Save changes"})})]})})]})})}const M=n.object({oldPassword:n.string().min(1,{message:"Password is required!"}).min(6,{message:"Password must be at least 6 characters!"}),newPassword:n.string().min(1,{message:"New password is required!"}),confirmNewPassword:n.string().min(1,{message:"Confirm password is required!"})}).refine(e=>e.oldPassword!==e.newPassword,{message:"New password must be different than old password",path:["newPassword"]}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"Passwords do not match!",path:["confirmNewPassword"]});function K(){const e=z(),{user:a}=P.useContext(_),r={oldPassword:"",newPassword:"",confirmNewPassword:""},t=F({mode:"all",resolver:A(M),defaultValues:r}),{reset:i,handleSubmit:m,formState:{isSubmitting:c}}=t,d=m(async g=>{try{const o=await I.post(T.user.security,{employee_id:a.employee_id,old_password:g.oldPassword,new_password:g.newPassword}),{error_code:x,message:E}=o.data;if(x!==0)throw new Error(E)}catch(o){const x=o instanceof Error&&o.message||typeof o=="object"&&(o==null?void 0:o.message)||o;q.error(x)}});return s.jsx(N,{methods:t,onSubmit:d,children:s.jsxs(w,{sx:{p:3,gap:3,display:"flex",flexDirection:"column"},children:[s.jsx(l.Text,{name:"oldPassword",type:e.value?"text":"password",label:"Old password",InputProps:{endAdornment:s.jsx(h,{position:"end",children:s.jsx(b,{onClick:e.onToggle,edge:"end",children:s.jsx(u,{icon:e.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),s.jsx(l.Text,{name:"newPassword",label:"New password",type:e.value?"text":"password",InputProps:{endAdornment:s.jsx(h,{position:"end",children:s.jsx(b,{onClick:e.onToggle,edge:"end",children:s.jsx(u,{icon:e.value?"solar:eye-bold":"solar:eye-closed-bold"})})})},helperText:s.jsxs(C,{component:"span",direction:"row",alignItems:"center",children:[s.jsx(u,{icon:"eva:info-fill",width:16,sx:{mr:.5}})," Password must be minimum 6+"]})}),s.jsx(l.Text,{name:"confirmNewPassword",type:e.value?"text":"password",label:"Confirm new password",InputProps:{endAdornment:s.jsx(h,{position:"end",children:s.jsx(b,{onClick:e.onToggle,edge:"end",children:s.jsx(u,{icon:e.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),s.jsx(S,{type:"submit",variant:"contained",loading:c,sx:{ml:"auto"},children:"Save changes"})]})})}const Q=[{value:"general",label:"General",icon:s.jsx(u,{icon:"solar:user-id-bold",width:24})},{value:"security",label:"Security",icon:s.jsx(u,{icon:"ic:round-vpn-key",width:24})}];function X(){const e=O("general");return s.jsxs(G,{children:[s.jsx(H,{heading:"Account",links:[{name:"User",href:B.main.user.root},{name:"Account"}],sx:{mb:{xs:3,md:5}}}),s.jsx(U,{value:e.value,onChange:e.onChange,sx:{mb:{xs:3,md:5}},children:Q.map(a=>s.jsx(Z,{label:a.label,icon:a.icon,value:a.value},a.value))}),e.value==="general"&&s.jsx($,{}),e.value==="security"&&s.jsx(K,{})]})}const y={title:`Account settings | Dashboard - ${L.site.name}`};function we(){return s.jsxs(s.Fragment,{children:[s.jsxs(p,{children:[s.jsxs("title",{children:[" ",y.title]}),s.jsx("meta",{name:"description",content:y.description})]}),s.jsx(X,{})]})}export{we as default};
